{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
  <head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-145178223-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-145178223-1');
</script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" type="text/css" href="{% static 'namhome.css' %}?v=0.1" />
    <link rel="stylesheet" type="text/css" href="{% static 'service_detail.css' %}?v=0.1" />
    <title>gugudog</title>
  </head>
  <body>

    <div class="banner top">
      <h2><a class="gugubanner" href="{% url 'home'%}">gugudog</a></h2>
    </div>

    <div class="service">

      <div class="zzimlist"> 

        <div class="wholeservicebox">

          <div class="service_box">

            <div class="service_banner">
              <img class="wcafe_icon" src="{% static 'detail_banner_wcafe.jpg' %}" />
            </div>

            <div class="service_detail">
              <!-- 회사명 charfield -->
              <div class="detail_txt"><h4>{{ service.company }}</h4></div>
              <!-- 서비스명 charfield -->
              <div class="detail_txt"><h5>{{ service.service_name }}</h5></div>
              <!-- 가격  integerfield -->
              <div class="detail_txt"><h4>{{ service.price }}원</h4></div>
            </div>
        
            <div class="zzim" name="{{ service.pk }}" value="Zzim">찜</div>
            <div class="heartbox"><img class =" heartbaby"src="{% static '148836.png' %}"></div>

          </div><!-- service_box end -->

          <div class="adment">
            <!-- 설명 textfield -->
            <h3>{{ service.description }}</h3>
            <!-- 구독한 유저수를 get_gudog_users를 이용해 표현 -->
            <p>{{ service.get_gudog_users }}명이 구독한 서비스에요</p>
            <!-- 찜한 유저수를 get_zzim_users를 이용해 표현 -->            
            <p>{{ service.get_zzim_users }}명이 찜한 서비스에요</p>            
          </div>

          <!-- 링크 charfield -->
          <a href="{{ service.link }}"><div class="linktoservice">사이트로 바로가기</div></a>

        </div><!-- wholeservicebox end -->

        <h2 id="isZzimed">{{ isZzimed }}</h2>
        <h2 id="isGuDoged">{{ isGuDoged }}</h2>
        <div class="new_service add_btn"><h3>추가하기<h3></div>

      </div><!-- zzimlist end -->

    </div><!-- service end -->

    <div class="banner bottom">
        <div class="icons">
          <a href="{% url 'service_all'%}"><img id="serviceall" src="{% static 'bottom_service_2.png' %}" />
            <p>스토어</p>
          </a>
        </div>
        <div class="icons">
          <a href="{% url 'home'%}"><img id="home" src="{% static 'bottom_home_3.png' %}"/>
            <p>홈</p>
          </a>
        </div>
        <div class="icons">
            <a href="{% url 'mypage'%}"><img id="mypage" src="{% static 'bottom_mypage_2.png' %}" />
            <p>마이페이지</p>
            </a>   
        </div>
      </div>
      <h2 id="isZzimed">{{ isZzimed }}</h2>
    <h2 id="isGuDoged">{{ isGuDoged }}</h2>

  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

  <script type="text/javascript">
    if($("#isGuDoged").text()) {
      $(".zzim").remove();
    }
    else if($("#isZzimed").text()) {
      $(".zzim").remove();
    }
    
    $(".zzim").click(function() {
      var pk = $(this).attr("name");
      $.ajax({
        type: "POST",
        url: "{% url 'zzim' %}",
        data: {
          pk: pk,
          csrfmiddlewaretoken: "{{ csrf_token }}"
        },
        dataType: "json",
        success: function(response) {
          $(".zzim").text(response.zzim);
        },
        error: function(request, response, status, error) {
          alert("찜이 안돼 시발");
          console.log(response);
          console.log(request);
          console.log(error);
        }
      });
    });
  </script>
</html>
